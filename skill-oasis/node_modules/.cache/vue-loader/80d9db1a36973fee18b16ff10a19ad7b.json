{"remainingRequest":"D:\\プログラミング\\ポートフォリオ\\skill-oasis\\skill-oasis\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\プログラミング\\ポートフォリオ\\skill-oasis\\skill-oasis\\src\\views\\Confirmsignup.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\プログラミング\\ポートフォリオ\\skill-oasis\\skill-oasis\\src\\views\\Confirmsignup.vue","mtime":1635646868722},{"path":"D:\\プログラミング\\ポートフォリオ\\skill-oasis\\skill-oasis\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1612412714520},{"path":"D:\\プログラミング\\ポートフォリオ\\skill-oasis\\skill-oasis\\node_modules\\babel-loader\\lib\\index.js","mtime":1612412714534},{"path":"D:\\プログラミング\\ポートフォリオ\\skill-oasis\\skill-oasis\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1612412714520},{"path":"D:\\プログラミング\\ポートフォリオ\\skill-oasis\\skill-oasis\\node_modules\\vue-loader\\lib\\index.js","mtime":1629275980431}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IEF1dGggfSBmcm9tICdhd3MtYW1wbGlmeSc7CmltcG9ydCB7IEFtcGxpZnlFdmVudEJ1cyB9IGZyb20gJ2F3cy1hbXBsaWZ5LXZ1ZSc7CgppbXBvcnQgeyBtYXBHZXR0ZXJzIH0gZnJvbSAndnVleCc7CgpleHBvcnQgZGVmYXVsdCB7CiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIGVtYWlsOiB0aGlzLiRyb3V0ZS5xdWVyeS5lbWFpbCwKICAgICAgdXNlcm5hbWU6IHRoaXMuJHJvdXRlLnF1ZXJ5LnVzZXJuYW1lLAogICAgICBwYXNzd29yZDogdGhpcy4kcm91dGUucXVlcnkucGFzc3dvcmQsCiAgICAgIGNvZGU6ICcnLAogICAgICBzaWduZWRJbjogZmFsc2UsCiAgICB9OwogIH0sCiAgY29tcHV0ZWQ6IHsKICAgIC4uLm1hcEdldHRlcnMoWydhdXRoU3RhdGUnLCAnbG9naW5Vc2VyJ10pLAogIH0sCiAgY3JlYXRlZCgpIHsKICAgIHRoaXMuaXNVc2VyU2lnbmVkSW4oKTsKICAgIEFtcGxpZnlFdmVudEJ1cy4kb24oJ2F1dGhTdGF0ZScsIChpbmZvKSA9PiB7CiAgICAgIGlmIChpbmZvID09PSAnc2lnbmVkSW4nKSB7CiAgICAgICAgdGhpcy5pc1VzZXJTaWduZWRJbigpOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuc2lnbmVkSW4gPSBmYWxzZTsKICAgICAgfQogICAgfSk7CiAgfSwKICBtZXRob2RzOiB7CiAgICBhc3luYyBpc1VzZXJTaWduZWRJbigpIHsKICAgICAgdHJ5IHsKICAgICAgICBjb25zdCB1c2VyT2JqID0gYXdhaXQgQXV0aC5jdXJyZW50QXV0aGVudGljYXRlZFVzZXIoKTsKICAgICAgICB0aGlzLnNpZ25lZEluID0gdHJ1ZTsKICAgICAgICB0aGlzLiRzdG9yZS5jb21taXQoJ3NldExvZ2luVXNlcicsIHsKICAgICAgICAgIHVzZXJOYW1lOiB1c2VyT2JqLnVzZXJuYW1lLAogICAgICAgICAgZW1haWw6IHVzZXJPYmouYXR0cmlidXRlcy5lbWFpbCwKICAgICAgICB9KTsKICAgICAgICBjb25zb2xlLmxvZyh1c2VyT2JqKTsKICAgICAgICBpZiAodXNlck9iai5hdHRyaWJ1dGVzLmVtYWlsX3ZlcmlmaWVkKSB7CiAgICAgICAgICB0aGlzLiRyb3V0ZXIucHVzaCgnTWFrZXByb2ZpbGUnKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgICBjb25zb2xlLmxvZyh0aGlzLmxvZ2luVXNlcik7CiAgICAgIH0gY2F0Y2ggKGVycikgewogICAgICAgIHRoaXMuc2lnbmVkSW4gPSBmYWxzZTsKICAgICAgICBjb25zb2xlLmxvZyhlcnIpOwogICAgICB9CiAgICB9LAogICAgYXN5bmMgY29uZmlybVNpZ25VcCgpIHsKICAgICAgdHJ5IHsKICAgICAgICBjb25zdCB1c2VyID0gYXdhaXQgQXV0aC5jb25maXJtU2lnblVwKHRoaXMudXNlcm5hbWUsIHRoaXMuY29kZSk7CiAgICAgICAgY29uc29sZS5sb2codXNlcik7CiAgICAgICAgYXdhaXQgQXV0aC5zaWduSW4odGhpcy5lbWFpbCwgdGhpcy5wYXNzd29yZCkudGhlbigodXNlcikgPT4gewogICAgICAgICAgdGhpcy5zaWduZWRJbiA9IHRydWU7CiAgICAgICAgICB0aGlzLiRzdG9yZS5jb21taXQoJ3NldExvZ2luVXNlcicsIHsKICAgICAgICAgICAgdXNlck5hbWU6IHVzZXIudXNlcm5hbWUsCiAgICAgICAgICAgIGVtYWlsOiB1c2VyLmF0dHJpYnV0ZXMuZW1haWwsCiAgICAgICAgICB9KTsKICAgICAgICAgIHRoaXMuJHJvdXRlci5wdXNoKHsgcGF0aDogJy9NYWtlcHJvZmlsZScgfSk7CiAgICAgICAgfSk7CiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgY29uc29sZS5sb2coJ2Vycm9yIGNvbmZpcm1pbmcgc2lnbiB1cCcsIGVycm9yKTsKICAgICAgfQogICAgfSwKICB9LAp9Owo="},{"version":3,"sources":["Confirmsignup.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA+CA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Confirmsignup.vue","sourceRoot":"src/views","sourcesContent":["<template>\n  <div class=\"container-fluid\" style=\"height: 960px\">\n    <div class=\"container\" style=\"margin-top: 100px\">\n      <div class=\"card d-flex mx-auto\" style=\"max-width: 650px\">\n        <div id=\"signup-tag\">登録確認</div>\n        <div class=\"mb-3 row\" style=\"text-align: center\">\n          <div class=\"row\" style=\"margin-top: 30px\">\n            <p>以下のアドレスに確認用のメールを送信しました。</p>\n            <p>コードを入力して本登録を完了してください。</p>\n            <p class=\"center\">\n              {{ this.email }}\n            </p>\n            <div class=\"row mb-3\">\n              <div class=\"col-6 mx-auto justify-content-center\">\n                <input\n                  v-model=\"code\"\n                  type=\"code\"\n                  class=\"form-control\"\n                  style=\"background-color: #eceeec; border: none\"\n                />\n              </div>\n            </div>\n            <div class=\"row\">\n              <div class=\"d-grid gap-2 col-12 mx-auto justify-content-center\">\n                <button\n                  class=\"btn\"\n                  type=\"button\"\n                  style=\"\n                    background-color: #79b270;\n                    color: #fff;\n                    border: #79b270;\n                    border-radius: 6px;\n                  \"\n                  @click=\"confirmSignUp()\"\n                  @submit=\"confirmSignUp()\"\n                >\n                  確認\n                </button>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n<script>\nimport { Auth } from 'aws-amplify';\nimport { AmplifyEventBus } from 'aws-amplify-vue';\n\nimport { mapGetters } from 'vuex';\n\nexport default {\n  data() {\n    return {\n      email: this.$route.query.email,\n      username: this.$route.query.username,\n      password: this.$route.query.password,\n      code: '',\n      signedIn: false,\n    };\n  },\n  computed: {\n    ...mapGetters(['authState', 'loginUser']),\n  },\n  created() {\n    this.isUserSignedIn();\n    AmplifyEventBus.$on('authState', (info) => {\n      if (info === 'signedIn') {\n        this.isUserSignedIn();\n      } else {\n        this.signedIn = false;\n      }\n    });\n  },\n  methods: {\n    async isUserSignedIn() {\n      try {\n        const userObj = await Auth.currentAuthenticatedUser();\n        this.signedIn = true;\n        this.$store.commit('setLoginUser', {\n          userName: userObj.username,\n          email: userObj.attributes.email,\n        });\n        console.log(userObj);\n        if (userObj.attributes.email_verified) {\n          this.$router.push('Makeprofile');\n        } else {\n          return;\n        }\n        console.log(this.loginUser);\n      } catch (err) {\n        this.signedIn = false;\n        console.log(err);\n      }\n    },\n    async confirmSignUp() {\n      try {\n        const user = await Auth.confirmSignUp(this.username, this.code);\n        console.log(user);\n        await Auth.signIn(this.email, this.password).then((user) => {\n          this.signedIn = true;\n          this.$store.commit('setLoginUser', {\n            userName: user.username,\n            email: user.attributes.email,\n          });\n          this.$router.push({ path: '/Makeprofile' });\n        });\n      } catch (error) {\n        console.log('error confirming sign up', error);\n      }\n    },\n  },\n};\n</script>\n<style>\n.signup {\n  margin-top: 100px;\n  text-align: center;\n}\n#signup-tag {\n  width: 200px;\n  color: #ffffff;\n  text-align: center;\n  border-bottom: 30px solid #79b270;\n  height: 0;\n}\n</style>\n"]}]}